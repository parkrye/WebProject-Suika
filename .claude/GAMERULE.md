# Fireworks Festival 게임 규칙

## 1. 게임 개요

**Fireworks Festival**은 여러 플레이어가 **순서대로 턴을 진행**하며,
폭죽을 발사해 합성하고 점수를 얻는 **협동 턴제 물리 퍼즐 게임**입니다.

- **인원**: 1~10명
- **목표**: 파티 전체 점수 최대화
- **테마**: 밤하늘 불꽃놀이 축제

---

## 2. 방 생성 및 참가

1. 닉네임 입력 후 로비 진입
2. **Create Room**: 새 방 생성 (방장이 됨)
3. **Join Room**: 기존 방에 참가
4. 방장 외 플레이어는 **Ready** 버튼으로 준비 완료 표시
5. 모든 플레이어 준비 완료 시 방장이 **Start Game** 클릭

---

## 3. 턴 진행 방식

| 단계 | 설명 |
|------|------|
| 1. 턴 시작 | 플레이어에게 폭죽이 자동 지급됨 (1초 후 발사 가능) |
| 2. 조준 | 터치/클릭으로 좌우 위치 조정 |
| 3. 발사 | 아래로 당겨서 발사 (슬링샷 방식) |
| 4. 안정화 | 폭죽이 안정될 때까지 대기 |
| 5. 턴 종료 | 다음 플레이어로 넘어감 |

- **턴 제한 시간**: 10초
- 시간 내 발사하지 않으면 현재 위치에서 자동 발사

---

## 4. 슬링샷 조작법

### 모바일 (터치)
1. 화면 하단 터치 → 좌우 드래그로 X 위치 조정
2. 아래로 당기기 → 발사 파워 조절
3. 손가락 떼기 → 발사

### PC (마우스)
1. 클릭 → 좌우 드래그로 X 위치 조정
2. 아래로 당기기 → 발사 파워 조절
3. 버튼 놓기 → 발사

### 발사 특성
- 당긴 거리에 비례하여 발사 속도 결정 (5~15)
- 발사된 폭죽은 **직선으로 비행** (중력 무시)
- 벽이나 다른 폭죽과 **충돌 후** 중력 적용 (위로 떠오름)

---

## 5. 물리 시스템

### 중력
- **역방향 중력**: 오브젝트가 위로 떠오름
- 폭죽은 **천장(상단)**에 쌓임

### 발사 메커니즘
- 발사 위치: 화면 하단 (Y=540)
- 발사된 폭죽: 직선 비행 유지
- 충돌 후: 위로 향하는 중력 적용

---

## 6. 폭죽 생성 규칙

### 폭죽 크기
- 크기 범위: **1 ~ 10**
- 크기가 클수록 반지름이 큼

### 지급 규칙
- 지급 가능 범위: **1 ~ min(현재 최대 크기, 5)**
- 중앙값에 가까운 크기가 더 자주 등장 (가중치 랜덤)

---

## 7. 충돌 및 합성 규칙

1. **동일 크기** 폭죽 2개가 접촉하면 **즉시 합성**
2. 합성 결과: 크기 + 1인 새 폭죽 생성
3. 합성 시 **튕김 효과**: 합성 전 속도의 120%로 튕김
4. **연쇄 합성**: 새 폭죽이 동일 크기와 닿으면 추가 합성 발생
5. **크기 10** 폭죽 2개 합성 시: 폭발 효과와 함께 사라짐 (주변 폭죽에 충격파)

```
크기 1 + 크기 1 → 크기 2
크기 2 + 크기 2 → 크기 3
...
크기 9 + 크기 9 → 크기 10
크기 10 + 크기 10 → 폭발! (충격파 + 사라짐)
```

---

## 8. 점수 규칙

### 합성 점수

| 결과 크기 | 점수 |
|----------|------|
| 2 | 10 |
| 3 | 30 |
| 4 | 80 |
| 5 | 150 |
| 6 | 250 |
| 7 | 400 |
| 8 | 600 |
| 9 | 850 |
| 10 | 1,200 |

- 한 턴에 여러 합성 발생 시 모든 점수 누적
- 점수는 **마지막으로 폭죽을 발사한 플레이어**에게 귀속

---

## 9. 게임 종료 조건

폭죽이 **게임오버 라인(하단)** 아래에 **2초 이상** 머물면 게임 종료

- 게임오버 라인: Y=500 (화면 하단 근처)
- 드롭 후 3초간 유예 기간 (새 카운트다운 시작 불가)
- 이미 진행 중인 카운트다운은 유예와 무관하게 계속됨
- 특정 플레이어가 아닌 파티 전체 게임 종료

---

## 10. 최종 점수 계산

게임 종료 후 다음 순서로 점수 연출:

### Step 1: 플레이어별 기여 점수 공개
각 플레이어가 획득한 개인 점수 순차 공개

### Step 2: 파티 점수 합산
모든 플레이어 점수의 합계

### Step 3: 인원 배율 적용

| 인원 | 배율 |
|------|------|
| 1명 | x1.00 |
| 2명 | x1.30 |
| 3명 | x1.48 |
| 4명 | x1.60 |
| 5명 | x1.70 |
| 6명 | x1.78 |
| 7명 | x1.85 |
| 8명 | x1.90 |
| 9명 | x1.95 |
| 10명 | x2.00 |

**공식**: `1 + ln(인원) / ln(10)`
- 인원이 많을수록 배율 증가
- 증가폭은 점점 감소 (로그 곡선)

### Step 4: 최종 점수 및 Top 3 공로자

```
최종 점수 = 파티 점수 × 인원 배율
```

개인 점수 기준 상위 3명에게 메달 부여:
- 🥇 1위
- 🥈 2위
- 🥉 3위

---

## 11. Play Again

게임 종료 후 **Play Again** 버튼 클릭 시:
- 같은 대기방으로 복귀
- 같은 플레이어들과 다시 게임 가능
- 모든 플레이어 점수 및 준비 상태 초기화

---

## 12. 사운드

| 상황 | 효과음 |
|------|--------|
| 로비 | lobby.mp3 (BGM) |
| 게임 중 | main.mp3 (BGM) |
| 폭죽 발사 | drop.mp3 |
| 폭죽 합성 | merge.mp3 |
| 턴 시작 | turn_start.mp3 |
| 게임 오버 | gameover.mp3 |
| UI 클릭 | click.mp3 |

- 우측 상단 🔊 버튼으로 볼륨 조절 가능
- BGM/SFX 개별 볼륨 조절 가능
- 설정은 localStorage에 자동 저장됨

---

## 13. 규칙 요약

- 1~10명이 순서대로 턴 진행 (10초 제한)
- 슬링샷으로 폭죽 발사 (아래로 당겨서 발사)
- 발사된 폭죽은 직선 비행 → 충돌 후 위로 떠오름
- 같은 크기 폭죽이 닿으면 합성 (크기 +1)
- 크기 10 폭죽 2개 합성 시 폭발 + 충격파
- 폭죽이 하단 라인 아래에 2초 머물면 게임 종료
- **파티 점수 = 모든 플레이어 점수 합계**
- **최종 점수 = 파티 점수 × 인원 배율** (최대 x2.0)
- 개인 점수 기준 Top 3 공로자 선정
- Play Again으로 같은 방에서 재도전 가능
